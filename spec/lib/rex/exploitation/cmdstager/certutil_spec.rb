# -*- coding:binary -*-
require 'spec_helper'

require 'rex/exploitation/cmdstager'

<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
<<<<<<< HEAD
RSpec.describe Rex::Exploitation::CmdStagerCertutil do
=======
describe Rex::Exploitation::CmdStagerCertutil do
>>>>>>> origin/4.11.2_release_pre-rails4
=======
describe Rex::Exploitation::CmdStagerCertutil do
>>>>>>> origin/chore/MSP-12110/celluloid-supervision-tree
=======
describe Rex::Exploitation::CmdStagerCertutil do
>>>>>>> origin/msf-complex-payloads
=======
describe Rex::Exploitation::CmdStagerCertutil do
>>>>>>> origin/msf-complex-payloads
=======
describe Rex::Exploitation::CmdStagerCertutil do
>>>>>>> origin/payload-generator.rb

  let(:exe) { "MZ" }

  subject(:cmd_stager) do
    described_class.new(exe)
  end

  describe '#generate' do
    it "returns an array of commands" do
      result = cmd_stager.generate

      expect(result).to be_kind_of(Array)
      expect(result).to_not be_empty
    end
  end

end
